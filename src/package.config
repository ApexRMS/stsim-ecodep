<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <package name="stsim-ecodep" displayName="Calculates ecological departure in ST-Sim using the LANDFIRE Fire Regime Condition Class" version="3.2.1" isAddOn="True" extendsPackage="stsim" configVersion="2.0000" url="https://github.com/ApexRMS/stsim-ecodep">
    <transformers>
      <transformer name="primary" isPrimary="True">
        <runtime>
          <transformer name="preprocess"/>
          <transformer name="postprocess"/>
        </runtime>
        <include>
          <transformer name="options"/>
        </include>
      </transformer>
      <transformer name="options" displayName="Ecological Departure Options">
        <datafeeds>
          <datafeed name="options" displayName="Ecological Departure" dataScope="Scenario">
            <datasheets>
              <datasheet name="Options" displayName="ED Options" isSingleRow="True">
                <columns>
                  <column name="OptionsID" dataType="Integer" isPrimary="True"/>
                  <column name="ScenarioID" dataType="Integer"/>
                  <column name="Timesteps"  dataType="Integer" validationType="WholeNumber" validationCondition="GreaterEqual" formula1="1" format="d"/>
                  <column name="TransitionAttributeTypeID" displayName="Transition Attribute" dataType="Integer" validationType="Datasheet" formula1="stsim__TransitionAttributeType"/>
                </columns>
              </datasheet>
              <datasheet name="ReferenceCondition" displayName="ED Reference Conditions">
                <columns>
                  <column name="ReferenceConditionID" dataType="Integer" isPrimary="True"/>
                  <column name="ScenarioID"  dataType="Integer"/>
                  <column name="StratumID" displayName="Stratum" dataType="Integer" validationType="Datasheet" formula1="stsim__Stratum" allowDbNull="False" displayNameSource="stsim__Terminology" displayNameColumn="PrimaryStratumLabel"/>
                  <column name="StateClassID" displayName="State Class" dataType="Integer" validationType="Datasheet" formula1="stsim__StateClass" />
                  <column name="RelativeAmount" displayName="Relative Amount" dataType="Integer" validationType="WholeNumber" validationCondition="GreaterEqual" formula1="0" allowDbNull="False"/>
                  <column name="Undesirability" dataType="Double" validationType="Decimal" validationCondition="Between" formula1="0.0" formula2="2.0"/>
                  <column name="Threshold" displayName="Threshold Percent" dataType="Double" validationType="Decimal" validationCondition="Between" formula1="0.0" formula2="100.0"/>
                </columns>
                <validations>
                  <validation validationType="Unique" columns="StratumID|StateClassID"/>
                </validations>
              </datasheet>
            </datasheets>
          </datafeed>
        </datafeeds>
      </transformer>
      <transformer 
        name="preprocess" 
        displayName="Ecological Departure Pre-Process" 
        className="SyncroSim.STSimEcoDep.PreProcessTransformer" 
        classAssembly="SyncroSim.STSimEcoDep" 
        extendsTransformer="stsim__runtime">
      </transformer>
      <transformer 
        name="postprocess" 
        displayName="Ecological Departure Post-Process" 
        className="SyncroSim.STSimEcoDep.PostProcessTransformer" 
        classAssembly="SyncroSim.STSimEcoDep" 
        runOrder="After" 
        extendsTransformer="stsim__runtime">
        <datafeeds>
          <datafeed name="output" dataScope="Scenario" isOutput="True">
            <datasheets>
              <datasheet name="Output" displayName="Ecological Departure">
                <columns>
                  <column name="ScenarioID" dataType="Integer" isCompositeIndex="True"/>
                  <column name="Iteration" dataType="Integer" isCompositeIndex="True" format="d"/>
                  <column name="Timestep" dataType="Integer" isCompositeIndex="True" format="d"/>
                  <column name="StratumID" dataType="Integer"/>
                  <column name="Departure" dataType="Double"/>
                  <column name="CumulativeAttribute" dataType="Double"/>
                </columns>
              </datasheet>
            </datasheets>
          </datafeed>
        </datafeeds>
      </transformer>
      <transformer 
        name="report" 
        displayName="Ecological Departure" 
        className="SyncroSim.STSimEcoDep.ReportTransformer" 
        classAssembly="SyncroSim.STSimEcoDep" 
        isExcelOnlyExport="True">
      </transformer>
    </transformers>
    <views>
      <view 
        name="options-view" 
        target="options" 
        className="SyncroSim.STSimEcoDep.OptionsDataFeedView" 
        classAssembly="SyncroSim.STSimEcoDep"/>
    </views>
    <layouts>
      <layout name="system_forms__scenario-datafeeds" appendTo="Advanced">
        <item name="options"/>
      </layout>
      <layout name="system_forms__result-transformers" appendTo="Export|Reports">
        <item name="report"/>
      </layout>
    </layouts>
    <updateProvider
      schemaVersion="100"
      minPackageVersion="3.2.1"
      className="SyncroSim.STSimEcoDep.DBUpdate"
      classAssembly="SyncroSim.STSimEcoDep"/>
  </package>
</configuration>
